{% extends 'base.html' %}
	
{% load static i18n custom_tags mathfilters thumbnail humanize %}

{% block content %}

{% include 'includes/home_header.html' %}

<!-- Start of Main -->
<main class="main">
    <!-- Start of Breadcrumb -->
    <nav class="breadcrumb-nav">
        <div class="container mt-2 mb-2">
            <ul class="breadcrumb bb-no">
                <li><a href="#">{% trans "Asosiy sahifa" %}</a></li>
                <li>{% trans "Mahsulotlar" %}</li>
            </ul>
        </div>
    </nav>
    <!-- End of Breadcrumb -->

    <!-- Start of Page Content -->
    <div class="page-content">
        <div class="container">
            <!-- Start of Shop Banner -->
            <div class="shop-default-banner banner d-flex align-items-center mb-5 br-xs"
                style="background-image: url({% static 'images/shop/banner1.jpg' %}); background-color: #FFC74E;">
                <div class="banner-content">
                    <h4 class="banner-subtitle font-weight-bold">Mahsulotlar to'plami</h4>
                    <h3 class="banner-title text-white text-uppercase font-weight-bolder ls-normal"></h3>
                    <a href="#" class="btn btn-dark btn-rounded btn-icon-right">Hoziroq xarid qiling<i class="w-icon-long-arrow-right"></i></a>
                </div>
            </div>
            <!-- End of Shop Banner -->

            <div class="shop-default-brands mb-5">
                <div class="brands-swiper swiper-container swiper-theme "
                    data-swiper-options="{
                        'slidesPerView': 2,
                        'breakpoints': {
                            '576': {
                                'slidesPerView': 3
                            },
                            '768': {
                                'slidesPerView': 4
                            },
                            '992': {
                                'slidesPerView': 6
                            },
                            '1200': {
                                'slidesPerView': 7
                            }
                        },
                        'autoplay': {
                            'delay': 4000,
                            'disableOnInteraction': false
                        }
                    }">
                    <div class="swiper-wrapper row gutter-no cols-xl-7 cols-lg-6 cols-md-4 cols-sm-3 cols-2">
                        {% for cat in categories %}
                        <div class="swiper-slide">
                            <figure>
                                {% thumbnail cat.image "160x90" as im %}
                                <img src="{{ cat.image.url }}" alt="{{cat.name}}" width="{{im.width}}" height="{{im.height}}" />
                                {% endthumbnail %}
                            </figure>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
            <!-- End of Shop Brands-->

            <!-- Start of Shop Category -->
            <div class="shop-default-category category-ellipse-section mb-6">
                <div class="swiper-container swiper-theme shadow-swiper"
                    data-swiper-options="{
                    'spaceBetween': 20,
                    'slidesPerView': 2,
                    'breakpoints': {
                        '480': {
                            'slidesPerView': 3
                        },
                        '576': {
                            'slidesPerView': 4
                        },
                        '768': {
                            'slidesPerView': 6
                        },
                        '992': {
                            'slidesPerView': 7
                        },
                        '1200': {
                            'slidesPerView': 8,
                            'spaceBetween': 30
                        }
                    }
                }">
                    <div class="swiper-wrapper row gutter-lg cols-xl-8 cols-lg-7 cols-md-6 cols-sm-4 cols-xs-3 cols-2">
                        {% for cat in categories %}
                        {% if not cat.is_leaf_node %}
                        <div class="swiper-slide category-wrap">
                            <div class="category category-ellipse">
                                <figure class="category-media">
                                    <a href="{{ cat.get_absolute_url }}">
                                    {% thumbnail cat.image "190x190" crop="center" as im %}
                                        <img src="{{ im.url }}" alt="{{ cat.name }}"
                                            width="{{ im.width }}" height="{{ im.height }}" style="background-color: #5C92C0;" />
                                    </a>
                                    {% endthumbnail %}
                                </figure>
                                <div class="category-content">
                                    <h4 class="category-name">
                                        <a href="{{ cat.get_absolute_url }}">{{ cat.name }}</a>
                                    </h4>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
            <!-- End of Shop Category -->
            
            <!-- Start of Shop Content -->
            <div class="shop-content row gutter-lg mb-10">
                
                <!-- Start of Sidebar, Shop Sidebar -->
                <aside class="sidebar shop-sidebar sticky-sidebar-wrapper sidebar-fixed">
                    <!-- Start of Sidebar Overlay -->
                    <div class="sidebar-overlay"></div>
                    <a class="sidebar-close" href="#"><i class="close-icon"></i></a>
                    <form action="{% url 'products:list' %}" id="left-filter">
                    <!-- Start of Sidebar Content -->
                    <div class="sidebar-content scrollable">
                        <!-- Start of Sticky Sidebar -->
                        <div class="sticky-sidebar">
                            <div class="filter-actions">
                                <label>{% trans "Saralash" %} :</label>
                                <a href="{% url 'products:list' %}" class="btn btn-dark btn-link filter-clean">{% trans "Bekor qilish" %}</a>
                            </div>
                            <!-- Start of Collapsible widget -->
                            <div class="widget widget-collapsible">
                                <h3 class="widget-title"><label>{% trans "Barcha kategoriyalar" %}</label></h3>
                                <div class="widget-body">
                                    {{ filter.form.category }}
                                </div>
                            </div>
                            <!-- End of Collapsible Widget -->

                            <!-- Start of Collapsible Widget -->
                            <div class="widget widget-collapsible">
                                <h3 class="widget-title"><label>{% trans "Narx" %}</label></h3>
                                <div class="widget-body">
                                    
                                    <div class="price-range d-flex">
                                        <input type="number" name="min_price" class="min_price text-center"
                                            placeholder="min" {% if filter.get_selected_min_price %}value="{{ filter.get_selected_min_price }}"{% endif %}><span class="delimiter">-</span>
                                        <input type="number" name="max_price" class="max_price text-center"
                                            placeholder="max" {% if filter.get_selected_max_price %}value="{{ filter.get_selected_max_price }}"{% endif %}>
                                    </div>
                                </div>
                            </div>
                            <!-- End of Collapsible Widget -->

                            <!-- Start of Collapsible Widget -->
                            <div class="widget widget-collapsible">
                                <h3 class="widget-title"><label>{% trans "Brend" %}</label></h3>
                                <div class="widget-body">
                                    {{ filter.form.brand }}
                                </div>
                            </div>
                            <!-- End of Collapsible Widget -->

                            <!-- Start of Collapsible Widget -->
                            <div class="widget widget-collapsible">
                                <h3 class="widget-title"><label>{% trans "Qo'shimcha" %}</label></h3>
                                <ul class="widget-body filter-items item-check mt-1">
                                   <li class="mb-2">
                                        <label class="d-flex align-items-center">
                                            <input type="checkbox" name="discount" class="mr-2" {% if filter.get_selected_discount %}checked{% endif %}>
                                            {% trans "Chegirma" %}
                                        <label>
                                    <li>
                                       <label class="d-flex align-items-center">
                                            <input type="checkbox" name="lising" class="mr-2" {% if filter.get_selected_lising %}checked{% endif %}>
                                            {% trans "Rassrochka" %}
                                        <label> 
                                    </li>
                                </ul>
                            </div>
                            <!-- End of Collapsible Widget -->
                            <input type="submit" class="btn btn-send" value="{% trans "Saralash" %}">
                        </div>
                        <!-- End of Sidebar Content -->
                    </div>
                    <!-- End of Sidebar Content -->
                    {% comment %} </form> {% endcomment %}
                </aside>
                <!-- End of Shop Sidebar -->
               
                <!-- Start of Shop Main Content -->
                <div class="main-content">
                    {% comment %} filter in navbar {% endcomment %}
                    {% comment %} <form action"." class="" id="top-filter"> {% endcomment %}
                    <nav class="toolbox sticky-toolbox sticky-content fix-top">
                        
                        <div class="toolbox-left">
                            <a href="#" class="btn btn-primary btn-outline btn-rounded left-sidebar-toggle 
                                btn-icon-left d-block d-lg-none">
                                <i class="w-icon-category"></i><span>Filters</span></a>
                            {% comment %} <div class="toolbox-item toolbox-sort select-box text-dark">
                                <label>Sort By :</label>
                                <select name="orderby" class="form-control">
                                    <option value="default" selected="selected">Default sorting</option>
                                    <option value="popularity">Sort by popularity</option>
                                    <option value="rating">Sort by average rating</option>
                                    <option value="date">Sort by latest</option>
                                    <option value="price-low">Sort by pric: low to high</option>
                                    <option value="price-high">Sort by price: high to low</option>
                                </select>
                            </div> {% endcomment %}
                        </div>
                        <div class="toolbox-right">
                            <div class="toolbox-item toolbox-show select-box">
                                <label>{% trans "Safidagi natijalar soni" %}</label>
                                <select name="paginate" class="form-control">
                                    <option value="9" {% if request.GET.paginate == '9' %}selected{% endif %}>{% trans "9 ta" %}</option>
                                    <option value="12" {% if request.GET.paginate == '12' %}selected{% endif %}>{% trans "12 ta" %}</option>
                                    <option value="20" {% if request.GET.paginate == '20' %}selected{% endif %}>{% trans "20 ta" %}</option>
                                    <option value="30" {% if request.GET.paginate == '30' %}selected{% endif %}>{% trans "30 ta" %}</option>
                                </select>
                            </div>
                            {% comment %} <div class="toolbox-item toolbox-layout">
                                <a href="shop-banner-sidebar.html" class="icon-mode-grid btn-layout active">
                                    <i class="w-icon-grid"></i>
                                </a>
                                <a href="shop-list.html" class="icon-mode-list btn-layout">
                                    <i class="w-icon-list"></i>
                                </a>
                            </div> {% endcomment %}
                        </div>
                        
                    </nav>
                    </form>
                    {% comment %} proiduct items {% endcomment %}
                    <div class="product-wrapper row cols-md-3 cols-sm-2 cols-2">
                        {% for p in object_list %}
                        <div class="product-wrap">
                            <div class="product text-center">
                                <figure class="product-media">
                                    <a href="{{ p.get_absolute_url }}">
                                    {% thumbnail p.get_first_image "268x268" crop="center" as im %}
                                        <img src="{{ im.url }}" alt="{{ p.name }}" width="{{im.width}}"
                                            height="{{ im.height }}"/>
                                    {% endthumbnail %}
                                    </a>
                                    <div class="product-action-horizontal">
                                        <a href="{% url 'cart:add' id=p.id %}" class="btn-product-icon btn-cart w-icon-cart {% if p.id|stringformat:'i' in cart.cart.keys %}text-primary{% endif %}"
                                            title="Add to cart"></a>
                                        <a href="{% url 'whishlist:add' id=p.id %}" class="btn-product-icon btn-wishlist w-icon-heart"
                                            title="Wishlist"></a>
                                        <a href="{% url 'compare:add' id=p.id %}" class="btn-product-icon btn-compare w-icon-compare {% if p.id|stringformat:'i' in cart.cart.keys %}text-primary{% else %}{% endif %}"
                                            title="Compare"></a>
                                        <!-- <a href="{% url 'whishlist:add' id=p.id %}" class="btn-product-icon btn-quickview w-icon-search"
                                            title="Quick View"></a> -->
                                    </div>
                                </figure>
                                <div class="product-details">
                                    <div class="product-cat">
                                        <a href="{{ p.category.get_absolute_url }}">{{ p.category.name }}</a>
                                    </div>
                                    <h3 class="product-name">
                                        <a href="{% url 'products:detail' cat_slug=p.category.slug slug=p.slug %}">{{ p.title }}</a>
                                    </h3>
                                    <div class="ratings-container">
                                        <div class="rating mr-2 noClick">
                                            <div class="star-content">
                                                {% for item in p.rating|mul:'i' %}
                                                <span class="fa fa-star checked"></span>
                                                {% endfor %}
                                                {% for item in 5|sub:p.rating|mul:'i' %}
                                                <span class="fa fa-star"></span>
                                                {% endfor %}
                                            </div>
                                        </div>
                                        <a href="{{ p.get_absolute_url }}" class="rating-reviews">(3 izohlar)</a>
                                    </div>
                                    <div class="product-pa-wrapper">
                                        <div class="product-price">
                                            {{ p.price|sum|floatformat:-2|intcomma }} UZS
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    {% include 'products/_includes/pagination.html' %}

                </div>
                <!-- End of Shop Main Content -->
            
            </div>
            <!-- End of Shop Content -->
        </div>
    </div>
    <!-- End of Page Content -->
</main>
<!-- End of Main -->

{% endblock content %}
